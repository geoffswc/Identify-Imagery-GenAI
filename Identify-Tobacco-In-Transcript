{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9a33c893-10b9-4151-a096-61c30282e55e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import re\n",
    "import json\n",
    "import base64\n",
    "import requests\n",
    "import time\n",
    "import urllib.parse\n",
    "import yaml\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "9a5e16a7-2874-41fb-89d7-b1cfc7ad8a6c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load YAML file\n",
    "def load_config(filename):\n",
    "    with open(filename, 'r') as file:\n",
    "        config = yaml.safe_load(file) \n",
    "    return config\n",
    "\n",
    "config = load_config('config.yml')\n",
    "\n",
    "\n",
    "API_KEY = config['API_KEY']\n",
    "API_VERSION = config['API_VERSION']\n",
    "RESOURCE_ENDPOINT = config['RESOURCE_ENDPOINT']\n",
    "DEPLOYMENT_MODEL = config['DEPLOYMENT_MODEL']\n",
    "MAX_RETRIES = config['MAX_RETRIES']\n",
    "RETRY_SECS = config[\"RETRY_SECS\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "d7099798-c18d-45f5-960f-3f008e3a224f",
   "metadata": {},
   "outputs": [],
   "source": [
    "chat_deployments = [\n",
    "    #'gpt-35-turbo',\n",
    "    #'gpt-35-turbo-0301',\n",
    "    #'gpt-4',\n",
    "    'gpt-35-turbo-16K',\n",
    "    #$'gpt-4-32K',\n",
    "    #'gpt-4-turbo-128k',\n",
    "    #'gpt-4o-2024-05-13',\n",
    "    #'gpt-4o-mini-2024-07-18',  # Added Oct 3, 2024\n",
    "    #'gpt-4o-2024-08-06',  # Added Oct 3, 2024\n",
    "]  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "aeeeba02-fee4-4a7d-bb17-0bd59af305fe",
   "metadata": {},
   "outputs": [],
   "source": [
    "# These are configurable parameters for managing re-attempts for API calls\n",
    "RETRY_SECS = 10  # Seconds between attempts\n",
    "MAX_RETRIES = 4  # Max number of re-attempts\n",
    "\n",
    "error_msg = \"\"\"\\nProvided your configuration parameters (API_KEY, API_VERSION, RESOURCE_ENDPOINT, deployment name) are valid, the majority of errors \n",
    "you may encounter with this code are attributable to temporary issues such as Azure server outages or other users who have triggered shared API rate\n",
    "limits for a given deployment. Please try again in a few minutes. However, if you receive a 401 Unauthorized access error, while your API key may have the correct length, most likely it is not a valid key for some other reason. \n",
    "In that event, please open a ticket with the Versa team at versa@ucsf.edu to review the key.\\n\"\"\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "16c3084e-4c26-42ae-aeb3-d327d963658c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# These two functions are helper functions\n",
    "def post_request(url, headers, body):\n",
    "    response = requests.post(url, headers=headers, data=body)\n",
    "        \n",
    "    response.raise_for_status()\n",
    "    return response\n",
    "\n",
    "def exception_code(retries, deployment_id, e):\n",
    "    if retries >= MAX_RETRIES:\n",
    "        print(f'Failed attempt {retries+1} of {MAX_RETRIES+1}.')\n",
    "        print(error_msg)\n",
    "        raise Exception(f\"Test failed for deployment: {deployment_id}, Error received: {e}\")\n",
    "    else:\n",
    "        print(f'Failed attempt {retries+1} of {MAX_RETRIES + 1}. Waiting {RETRY_SECS} secs before next attempt...')\n",
    "        \n",
    "    retries += 1\n",
    "    time.sleep(RETRY_SECS)\n",
    "    \n",
    "    return retries\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "58573c09-fdfb-47d4-aabf-965c264dd751",
   "metadata": {},
   "outputs": [],
   "source": [
    "def test_chat_completions(text, simulate_api_error=False):\n",
    "    #deployments = ['fake_deployment'] if simulate_api_error else chat_deployments\n",
    "\n",
    "    deployment_id = chat_deployments[0]\n",
    "    #print(f\"\\nTesting chat completions for deployment: {deployment_id}\")\n",
    "    url = f'{RESOURCE_ENDPOINT}/openai/deployments/{deployment_id}/chat/completions?api-version={API_VERSION}'\n",
    "    prompt = \"\"\"\n",
    "    Analyze the following text for any tobacco smoking related elements. \n",
    "    The goal is to accurately determine whether such language is present, without assuming it is present. \n",
    "    Reply in two parts. the first is a binary yes/no about the presence of tobacco or smoking. Only yes or no in this answer\n",
    "    The second is a brief description. If no smoking is present, reply 'none'.\n",
    "    use a semicolon to delmit the two parts of the reply\n",
    "    to make sure this works, do not include a semicolon in any other part of your reply\n",
    "    \"\"\"\n",
    "\n",
    "    prompt += \": \" + text\n",
    "    \n",
    "    #print(f\"Deployment URL: {url}\")\n",
    "\n",
    "    body = json.dumps({\n",
    "        \"messages\": [{\"role\": \"user\", \"content\": prompt}]\n",
    "    })\n",
    "    headers = {'Content-Type': 'application/json', 'api-key': API_KEY}\n",
    "\n",
    "    retries = 0\n",
    "\n",
    "\n",
    "    response = post_request(url, headers, body)\n",
    "\n",
    "    #print('User: ', prompt)\n",
    "    #print('Response: ', json.loads(response.text).get('choices')[0].get('message').get('content'))\n",
    "\n",
    "    return json.loads(response.text).get('choices')[0].get('message').get('content')\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "6a763c5e-8a2a-426b-87fb-a9e2505916ab",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "ee5148f8-06cd-4c39-a17f-5fa001a61fdb",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('camel_transcripts/transcription_camel.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "7b37d1da-5dbb-4ec4-a143-a816d9f2b17a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>file_name</th>\n",
       "      <th>time_stamp</th>\n",
       "      <th>transcription</th>\n",
       "      <th>smoking_mentioned</th>\n",
       "      <th>smoking_context</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[0.00s - 10.00s]</td>\n",
       "      <td>I'd like some pastel colored cigarettes.</td>\n",
       "      <td>yes</td>\n",
       "      <td>Mentions a desire for pastel-colored cigarette...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[10.00s - 11.00s]</td>\n",
       "      <td>That's your feather?</td>\n",
       "      <td>no</td>\n",
       "      <td>No mention or implication of smoking.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[11.00s - 12.00s]</td>\n",
       "      <td>You silly.</td>\n",
       "      <td>no</td>\n",
       "      <td>General dialogue with no reference to smoking.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[12.00s - 13.00s]</td>\n",
       "      <td>There you are.</td>\n",
       "      <td>no</td>\n",
       "      <td>No connection to smoking.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[13.00s - 16.00s]</td>\n",
       "      <td>Come along, I'll win you.</td>\n",
       "      <td>no</td>\n",
       "      <td>Figurative or playful comment, unrelated to sm...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[16.00s - 18.00s]</td>\n",
       "      <td>What have you got in those frosty cigarettes?</td>\n",
       "      <td>yes</td>\n",
       "      <td>References cigarettes and implies curiosity ab...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[18.00s - 19.00s]</td>\n",
       "      <td>How about these?</td>\n",
       "      <td>no</td>\n",
       "      <td>Ambiguous without smoking context.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[19.00s - 20.00s]</td>\n",
       "      <td>Thank you.</td>\n",
       "      <td>no</td>\n",
       "      <td>No smoking-related content.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[20.00s - 22.00s]</td>\n",
       "      <td>I want the most feminine cigarette you have.</td>\n",
       "      <td>yes</td>\n",
       "      <td>Direct request for a type of cigarette.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[22.00s - 25.00s]</td>\n",
       "      <td>Yeah, and let me have some scented cigarettes ...</td>\n",
       "      <td>yes</td>\n",
       "      <td>Direct mention of scented cigarettes.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[25.00s - 26.00s]</td>\n",
       "      <td>I'm out of Sandlewood.</td>\n",
       "      <td>yes</td>\n",
       "      <td>Refers back to the Sandlewood cigarette box me...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[26.00s - 27.00s]</td>\n",
       "      <td>I told you.</td>\n",
       "      <td>no</td>\n",
       "      <td>Lacks context; no clear connection to smoking.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[27.00s - 33.00s]</td>\n",
       "      <td>I say, you have some spare cigarettes in the r...</td>\n",
       "      <td>yes</td>\n",
       "      <td>Explicit request for more cigarettes.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[33.00s - 35.00s]</td>\n",
       "      <td>Or is it the other way around?</td>\n",
       "      <td>no</td>\n",
       "      <td>No smoking-related content.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[35.00s - 38.00s]</td>\n",
       "      <td>In this fancy, frilly you've got to have a gim...</td>\n",
       "      <td>no</td>\n",
       "      <td>General cultural commentary, no smoking refere...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[38.00s - 40.00s]</td>\n",
       "      <td>There's one cigarette that doesn't go along.</td>\n",
       "      <td>yes</td>\n",
       "      <td>Highlights a particular cigarette in contrast ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[40.00s - 44.00s]</td>\n",
       "      <td>Camel filters, please.</td>\n",
       "      <td>yes</td>\n",
       "      <td>Direct brand and product reference.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[44.00s - 51.00s]</td>\n",
       "      <td>We're not about to hide our kind of easy taste...</td>\n",
       "      <td>yes</td>\n",
       "      <td>Likely part of a cigarette ad emphasizing auth...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[51.00s - 52.00s]</td>\n",
       "      <td>Camel filters.</td>\n",
       "      <td>yes</td>\n",
       "      <td>Brand name mentioned — implies smoking.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[52.00s - 54.00s]</td>\n",
       "      <td>They're not for everybody.</td>\n",
       "      <td>yes</td>\n",
       "      <td>Implicit continuation of a cigarette ad narrat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[54.00s - 56.00s]</td>\n",
       "      <td>But then they don't try to be.</td>\n",
       "      <td>yes</td>\n",
       "      <td>Further branding language likely related to sm...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              file_name         time_stamp  \\\n",
       "0   Camel%20filters.mp4   [0.00s - 10.00s]   \n",
       "1   Camel%20filters.mp4  [10.00s - 11.00s]   \n",
       "2   Camel%20filters.mp4  [11.00s - 12.00s]   \n",
       "3   Camel%20filters.mp4  [12.00s - 13.00s]   \n",
       "4   Camel%20filters.mp4  [13.00s - 16.00s]   \n",
       "5   Camel%20filters.mp4  [16.00s - 18.00s]   \n",
       "6   Camel%20filters.mp4  [18.00s - 19.00s]   \n",
       "7   Camel%20filters.mp4  [19.00s - 20.00s]   \n",
       "8   Camel%20filters.mp4  [20.00s - 22.00s]   \n",
       "9   Camel%20filters.mp4  [22.00s - 25.00s]   \n",
       "10  Camel%20filters.mp4  [25.00s - 26.00s]   \n",
       "11  Camel%20filters.mp4  [26.00s - 27.00s]   \n",
       "12  Camel%20filters.mp4  [27.00s - 33.00s]   \n",
       "13  Camel%20filters.mp4  [33.00s - 35.00s]   \n",
       "14  Camel%20filters.mp4  [35.00s - 38.00s]   \n",
       "15  Camel%20filters.mp4  [38.00s - 40.00s]   \n",
       "16  Camel%20filters.mp4  [40.00s - 44.00s]   \n",
       "17  Camel%20filters.mp4  [44.00s - 51.00s]   \n",
       "18  Camel%20filters.mp4  [51.00s - 52.00s]   \n",
       "19  Camel%20filters.mp4  [52.00s - 54.00s]   \n",
       "20  Camel%20filters.mp4  [54.00s - 56.00s]   \n",
       "\n",
       "                                        transcription smoking_mentioned  \\\n",
       "0            I'd like some pastel colored cigarettes.               yes   \n",
       "1                                That's your feather?                no   \n",
       "2                                          You silly.                no   \n",
       "3                                      There you are.                no   \n",
       "4                           Come along, I'll win you.                no   \n",
       "5       What have you got in those frosty cigarettes?               yes   \n",
       "6                                    How about these?                no   \n",
       "7                                          Thank you.                no   \n",
       "8        I want the most feminine cigarette you have.               yes   \n",
       "9   Yeah, and let me have some scented cigarettes ...               yes   \n",
       "10                             I'm out of Sandlewood.               yes   \n",
       "11                                        I told you.                no   \n",
       "12  I say, you have some spare cigarettes in the r...               yes   \n",
       "13                     Or is it the other way around?                no   \n",
       "14  In this fancy, frilly you've got to have a gim...                no   \n",
       "15       There's one cigarette that doesn't go along.               yes   \n",
       "16                             Camel filters, please.               yes   \n",
       "17  We're not about to hide our kind of easy taste...               yes   \n",
       "18                                     Camel filters.               yes   \n",
       "19                         They're not for everybody.               yes   \n",
       "20                     But then they don't try to be.               yes   \n",
       "\n",
       "                                      smoking_context  \n",
       "0   Mentions a desire for pastel-colored cigarette...  \n",
       "1               No mention or implication of smoking.  \n",
       "2      General dialogue with no reference to smoking.  \n",
       "3                           No connection to smoking.  \n",
       "4   Figurative or playful comment, unrelated to sm...  \n",
       "5   References cigarettes and implies curiosity ab...  \n",
       "6                  Ambiguous without smoking context.  \n",
       "7                         No smoking-related content.  \n",
       "8             Direct request for a type of cigarette.  \n",
       "9               Direct mention of scented cigarettes.  \n",
       "10  Refers back to the Sandlewood cigarette box me...  \n",
       "11     Lacks context; no clear connection to smoking.  \n",
       "12              Explicit request for more cigarettes.  \n",
       "13                        No smoking-related content.  \n",
       "14  General cultural commentary, no smoking refere...  \n",
       "15  Highlights a particular cigarette in contrast ...  \n",
       "16                Direct brand and product reference.  \n",
       "17  Likely part of a cigarette ad emphasizing auth...  \n",
       "18            Brand name mentioned — implies smoking.  \n",
       "19  Implicit continuation of a cigarette ad narrat...  \n",
       "20  Further branding language likely related to sm...  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "4e329e93-09bc-47db-9e00-83edd517ca3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# quick one line test\n",
    "#text = \"\"\"would you like a cigarette it sure would be nice to smoke one how about smoking a tobacco cigarette\"\"\"\n",
    "#text_none = \"\"\"would you like a cup of tea\"\"\"\n",
    "#resp = test_chat_completions(text_none)\n",
    "#resp.split(';')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "2288d88f-5e78-4372-a711-95bc6e7ea7e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "df[['smoking_related', 'smoking_context']] = df['transcription'].apply(\n",
    "    lambda x: pd.Series(test_chat_completions(x).split(';', 1))\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "2a582efb-a0b2-4394-8ec0-7503152c213e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>file_name</th>\n",
       "      <th>time_stamp</th>\n",
       "      <th>transcription</th>\n",
       "      <th>smoking_mentioned</th>\n",
       "      <th>smoking_context</th>\n",
       "      <th>smoking_related</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[0.00s - 10.00s]</td>\n",
       "      <td>I'd like some pastel colored cigarettes.</td>\n",
       "      <td>yes</td>\n",
       "      <td>The presence of the word \"cigarettes\" indicat...</td>\n",
       "      <td>yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[10.00s - 11.00s]</td>\n",
       "      <td>That's your feather?</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[11.00s - 12.00s]</td>\n",
       "      <td>You silly.</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[12.00s - 13.00s]</td>\n",
       "      <td>There you are.</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[13.00s - 16.00s]</td>\n",
       "      <td>Come along, I'll win you.</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[16.00s - 18.00s]</td>\n",
       "      <td>What have you got in those frosty cigarettes?</td>\n",
       "      <td>yes</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[18.00s - 19.00s]</td>\n",
       "      <td>How about these?</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[19.00s - 20.00s]</td>\n",
       "      <td>Thank you.</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[20.00s - 22.00s]</td>\n",
       "      <td>I want the most feminine cigarette you have.</td>\n",
       "      <td>yes</td>\n",
       "      <td>The text contains language related to tobacco ...</td>\n",
       "      <td>yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[22.00s - 25.00s]</td>\n",
       "      <td>Yeah, and let me have some scented cigarettes ...</td>\n",
       "      <td>yes</td>\n",
       "      <td>The text mentions \"cigarettes\" which are comm...</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[25.00s - 26.00s]</td>\n",
       "      <td>I'm out of Sandlewood.</td>\n",
       "      <td>yes</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[26.00s - 27.00s]</td>\n",
       "      <td>I told you.</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[27.00s - 33.00s]</td>\n",
       "      <td>I say, you have some spare cigarettes in the r...</td>\n",
       "      <td>yes</td>\n",
       "      <td>The text contains a reference to cigarettes, ...</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[33.00s - 35.00s]</td>\n",
       "      <td>Or is it the other way around?</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[35.00s - 38.00s]</td>\n",
       "      <td>In this fancy, frilly you've got to have a gim...</td>\n",
       "      <td>no</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[38.00s - 40.00s]</td>\n",
       "      <td>There's one cigarette that doesn't go along.</td>\n",
       "      <td>yes</td>\n",
       "      <td>The text mentions a cigarette, indicating the...</td>\n",
       "      <td>yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[40.00s - 44.00s]</td>\n",
       "      <td>Camel filters, please.</td>\n",
       "      <td>yes</td>\n",
       "      <td>The text mentions \"Camel filters,\" which is a...</td>\n",
       "      <td>yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[44.00s - 51.00s]</td>\n",
       "      <td>We're not about to hide our kind of easy taste...</td>\n",
       "      <td>yes</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[51.00s - 52.00s]</td>\n",
       "      <td>Camel filters.</td>\n",
       "      <td>yes</td>\n",
       "      <td>The text mentions \"Camel filters,\" which is a...</td>\n",
       "      <td>yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[52.00s - 54.00s]</td>\n",
       "      <td>They're not for everybody.</td>\n",
       "      <td>yes</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Camel%20filters.mp4</td>\n",
       "      <td>[54.00s - 56.00s]</td>\n",
       "      <td>But then they don't try to be.</td>\n",
       "      <td>yes</td>\n",
       "      <td>none</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              file_name         time_stamp  \\\n",
       "0   Camel%20filters.mp4   [0.00s - 10.00s]   \n",
       "1   Camel%20filters.mp4  [10.00s - 11.00s]   \n",
       "2   Camel%20filters.mp4  [11.00s - 12.00s]   \n",
       "3   Camel%20filters.mp4  [12.00s - 13.00s]   \n",
       "4   Camel%20filters.mp4  [13.00s - 16.00s]   \n",
       "5   Camel%20filters.mp4  [16.00s - 18.00s]   \n",
       "6   Camel%20filters.mp4  [18.00s - 19.00s]   \n",
       "7   Camel%20filters.mp4  [19.00s - 20.00s]   \n",
       "8   Camel%20filters.mp4  [20.00s - 22.00s]   \n",
       "9   Camel%20filters.mp4  [22.00s - 25.00s]   \n",
       "10  Camel%20filters.mp4  [25.00s - 26.00s]   \n",
       "11  Camel%20filters.mp4  [26.00s - 27.00s]   \n",
       "12  Camel%20filters.mp4  [27.00s - 33.00s]   \n",
       "13  Camel%20filters.mp4  [33.00s - 35.00s]   \n",
       "14  Camel%20filters.mp4  [35.00s - 38.00s]   \n",
       "15  Camel%20filters.mp4  [38.00s - 40.00s]   \n",
       "16  Camel%20filters.mp4  [40.00s - 44.00s]   \n",
       "17  Camel%20filters.mp4  [44.00s - 51.00s]   \n",
       "18  Camel%20filters.mp4  [51.00s - 52.00s]   \n",
       "19  Camel%20filters.mp4  [52.00s - 54.00s]   \n",
       "20  Camel%20filters.mp4  [54.00s - 56.00s]   \n",
       "\n",
       "                                        transcription smoking_mentioned  \\\n",
       "0            I'd like some pastel colored cigarettes.               yes   \n",
       "1                                That's your feather?                no   \n",
       "2                                          You silly.                no   \n",
       "3                                      There you are.                no   \n",
       "4                           Come along, I'll win you.                no   \n",
       "5       What have you got in those frosty cigarettes?               yes   \n",
       "6                                    How about these?                no   \n",
       "7                                          Thank you.                no   \n",
       "8        I want the most feminine cigarette you have.               yes   \n",
       "9   Yeah, and let me have some scented cigarettes ...               yes   \n",
       "10                             I'm out of Sandlewood.               yes   \n",
       "11                                        I told you.                no   \n",
       "12  I say, you have some spare cigarettes in the r...               yes   \n",
       "13                     Or is it the other way around?                no   \n",
       "14  In this fancy, frilly you've got to have a gim...                no   \n",
       "15       There's one cigarette that doesn't go along.               yes   \n",
       "16                             Camel filters, please.               yes   \n",
       "17  We're not about to hide our kind of easy taste...               yes   \n",
       "18                                     Camel filters.               yes   \n",
       "19                         They're not for everybody.               yes   \n",
       "20                     But then they don't try to be.               yes   \n",
       "\n",
       "                                      smoking_context smoking_related  \n",
       "0    The presence of the word \"cigarettes\" indicat...             yes  \n",
       "1                                                none              no  \n",
       "2                                                none              no  \n",
       "3                                                none              no  \n",
       "4                                                none              no  \n",
       "5                                                none              no  \n",
       "6                                                none              no  \n",
       "7                                                none              no  \n",
       "8   The text contains language related to tobacco ...             yes  \n",
       "9    The text mentions \"cigarettes\" which are comm...             Yes  \n",
       "10                                               none              no  \n",
       "11                                               none              no  \n",
       "12   The text contains a reference to cigarettes, ...             Yes  \n",
       "13                                               none              no  \n",
       "14                                               none              no  \n",
       "15   The text mentions a cigarette, indicating the...             yes  \n",
       "16   The text mentions \"Camel filters,\" which is a...             yes  \n",
       "17                                               none              no  \n",
       "18   The text mentions \"Camel filters,\" which is a...             yes  \n",
       "19                                               none              no  \n",
       "20                                               none              no  "
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cbbac80-b283-4d29-a338-8b9be0209c50",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
